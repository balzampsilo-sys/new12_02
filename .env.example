# ============================================
# TELEGRAM BOT CONFIGURATION
# ============================================

# Bot Token from @BotFather
BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz-Example

# Admin Telegram IDs (comma-separated)
# Get your ID from @userinfobot
ADMIN_IDS=123456789,987654321

# Max admin additions per hour (security)
MAX_ADMIN_ADDITIONS_PER_HOUR=3


# ============================================
# DATABASE CONFIGURATION
# ============================================

# Database type: "postgresql" (recommended) or "sqlite" (legacy)
DB_TYPE=postgresql

# PostgreSQL connection (multi-tenant with schema isolation)
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://booking_user:SecurePass2026!@postgres:5432/booking_saas

# ✅ NEW: PostgreSQL Schema for client isolation
# Each client gets unique schema (client_001, client_002, etc)
PG_SCHEMA=client_001

# SQLite path (legacy, only if DB_TYPE=sqlite)
DATABASE_PATH=data/bookings.db

# Connection pool settings (PostgreSQL only)
DB_POOL_MIN_SIZE=2
DB_POOL_MAX_SIZE=10
DB_POOL_TIMEOUT=30.0
DB_COMMAND_TIMEOUT=60.0

# Database retry logic
DB_MAX_RETRIES=3
DB_RETRY_DELAY=0.5
DB_RETRY_BACKOFF=2.0


# ============================================
# REDIS CONFIGURATION (FSM STORAGE)
# ============================================

# Enable Redis for FSM state storage
REDIS_ENABLED=True

# Redis connection
REDIS_HOST=redis-shared
REDIS_PORT=6379

# ✅ CHANGED: All clients use DB 0 (unlimited clients via key prefix)
REDIS_DB=0

# Redis password (optional)
REDIS_PASSWORD=

# ✅ NEW: Client ID for key prefix isolation
# Format: client_XXX (unique per client)
# All Redis keys will be: client_001:fsm:state:...
CLIENT_ID=client_001
REDIS_KEY_PREFIX=client_001:


# ============================================
# BUSINESS SETTINGS
# ============================================

# Company information
COMPANY_NAME=Салон красоты
SERVICE_LOCATION=г. Москва, ул. Примерная, 1

# Working hours (24-hour format)
WORK_HOURS_START=9
WORK_HOURS_END=18

# Booking limits
MAX_BOOKINGS_PER_USER=3
CANCELLATION_HOURS=24


# ============================================
# REMINDERS & NOTIFICATIONS
# ============================================

# Reminder timings (hours before appointment)
REMINDER_HOURS_BEFORE_24H=24
REMINDER_HOURS_BEFORE_2H=2
REMINDER_HOURS_BEFORE_1H=1

# Feedback request (hours after appointment)
FEEDBACK_HOURS_AFTER=2


# ============================================
# ONBOARDING
# ============================================

# Delays between onboarding messages (seconds)
ONBOARDING_DELAY_SHORT=1.5
ONBOARDING_DELAY_LONG=3.0


# ============================================
# CALENDAR SETTINGS
# ============================================

# How many months ahead users can book
CALENDAR_MAX_MONTHS_AHEAD=3


# ============================================
# BACKUP CONFIGURATION
# ============================================

# Enable automatic backups
BACKUP_ENABLED=True

# Backup directory
BACKUP_DIR=backups

# Backup interval (hours)
BACKUP_INTERVAL_HOURS=24

# Backup retention (days)
BACKUP_RETENTION_DAYS=30


# ============================================
# RATE LIMITING
# ============================================

# Rate limits (seconds between requests)
RATE_LIMIT_MESSAGE=0.5
RATE_LIMIT_CALLBACK=0.3

# Broadcast delay (seconds between messages)
BROADCAST_DELAY=0.05


# ============================================
# MONITORING & LOGGING
# ============================================

# Sentry error monitoring (optional)
SENTRY_ENABLED=False
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1


# ============================================
# ADVANCED SETTINGS
# ============================================

# Callback validation version
CALLBACK_VERSION=v3

# Callback message TTL (hours)
CALLBACK_MESSAGE_TTL_HOURS=48
